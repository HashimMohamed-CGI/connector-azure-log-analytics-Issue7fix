{
  "description": "Log Analytics is a service that helps you collect and analyze data generated by resources in your cloud and on-premises environments. This connector facilitates the automated operations related to query and saved searches.",
  "category": "Analytics & SIEM",
  "name": "azure-log-analytics",
  "label": "Azure Log Analytics",
  "version": "1.0.0",
  "publisher": "Community",
  "cs_approved": false,
  "cs_compatible": true,
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "help_online": "",
  "configuration": {
    "fields": [
      {
        "title": "Server URL",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "text",
        "name": "resource",
        "value": "https://graph.microsoft.com",
        "description": "The service-based URI to which you will connect and perform the automated operations."
      },
      {
        "title": "Client ID",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "text",
        "name": "client_id",
        "description": "Unique API ID of the Azure Active Directory application that is used to create an authentication token required to access the API."
      },
      {
        "title": "Client Secret",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "password",
        "name": "client_secret",
        "description": "Unique API Secret of the Azure Active Directory application that is used to create an authentication token required to access the API. For information on how to get the secret key, see 'https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/exposed-apis-create-app-webapp'."
      },
      {
        "title": "Tenant ID",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "text",
        "name": "tenant_id",
        "description": "ID of the tenant that you have been provided for your Azure Active Directory instance."
      },
      {
        "title": "Authorization Code",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "password",
        "name": "code",
        "tooltip": "Authorization code that you acquired in the authorization step.",
        "description": "(Only Applicable to On behalf of User – Delegate Permission) The authorization code that you acquired during the authorization step. For more information, see the Getting Access Tokens using the Delegate Permissions method section."
      },
      {
        "title": "Redirect URL",
        "description": "The redirect_uri of your app, where authentication responses can be sent and received by your app. It must exactly match one of the redirect_uri's you registered in the app registration portal.",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "text",
        "name": "redirect_url",
        "placeholder": "E.g. https://localhost/myapp",
        "tooltip": "(Only Applicable to On behalf of User – Delegate Permission) The redirect_uri of your app, where authentication responses can be sent and received by your app. The redirect URL that you specify here must exactly match one of the redirect_uri's you have registered in your app registration portal."
      },
      {
        "title": "Verify SSL",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "checkbox",
        "name": "verify_ssl",
        "value": true,
        "description": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True."
      }
    ]
  },
  "operations": [
    {
      "title": "Execute Query",
      "operation": "execute_query",
      "description": "Retrieves all data associated with a specific query from Azure Log Analytics based on the workspace ID and query that you have specified.",
      "category": "investigation ",
      "annotation": "execute_query",
      "parameters": [
        {
          "title": "Workspace ID",
          "description": "Azure Log Analytics workspace ID from which you want to retrieve the data.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "WorkspaceId"
        },
        {
          "title": "Query",
          "description": "Query based on which you want to retrieve data from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "query",
          "placeholder": "Usage | take 10",
          "tooltip": "Query based on which you want to retrieve data Azure Log Analytics."
        },
        {
          "title": "TimeSpan",
          "description": "The timespan over which to query data. This is an ISO8601 time period value. This timespan is applied in addition to any timespans specified in the query expression.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "timespan",
          "placeholder": "PT12H"
        },
        {
          "title": "Workspace Name",
          "description": "Name of the workspace based on which you want to retrieve the data from Azure Log Analytics.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "workspaces",
          "tooltip": "Comma-separated list of workspace names to retrieve the data from Azure Log Analytics."
        }
      ],
      "output_schema": {
        "tables": [
          {
            "name": "",
            "columns": [],
            "rows": []
          }
        ]
      },
      "enabled": true
    },
    {
      "title": "List Saved Searches",
      "operation": "list_saved_searches",
      "description": "Retrieves the list of saved searches from Azure Log Analytics based on the input parameters you have specified.",
      "category": "investigation ",
      "annotation": "list_saved_searches",
      "parameters": [
        {
          "title": "Workspace Resource Group",
          "description": "Azure active directory resource group from which you want to retrieve the saved searches from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "resourceGroupName"
        },
        {
          "title": "Workspace Subscription ID",
          "description": "Azure active directory subscription ID from which you want to retrieve the saved searches from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "subscriptionId"
        },
        {
          "title": "Workspace Name",
          "description": "Name of the workspace from which you want to retrieve the saved searches from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "workspaceName"
        }
      ],
      "output_schema": [
        {
          "id": "",
          "etag": "",
          "properties": {
            "Category": "",
            "DisplayName": "",
            "Query": "",
            "Tags": [
            ],
            "Version": ""
          }
        }
      ],
      "enabled": true
    },
    {
      "title": "Get Saved Searches",
      "operation": "get_saved_searches",
      "description": "Retrieves information for a specific saved searches from Azure Log Analytics, based on the saved search ID and other input parameters you have specified.",
      "category": "investigation",
      "annotation": "get_saved_searches",
      "parameters": [
        {
          "title": "Saved Search ID",
          "description": "ID of the saved search that you want to retrieve from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "savedSearchId"
        },
        {
          "title": "Workspace Resource Group",
          "description": "Azure active directory resource group from which you want to retrieve the saved searches from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "resourceGroupName"
        },
        {
          "title": "Workspace Subscription ID",
          "description": "Azure active directory subscription ID from which you want to retrieve the saved searches from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "subscriptionId"
        },
        {
          "title": "Workspace Name",
          "description": "Name of the workspace from which you want to retrieve the saved searches from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "workspaceName"
        }
      ],
      "output_schema": {
        "id": "",
        "etag": "",
        "properties": {
          "category": "",
          "displayName": "",
          "functionAlias": "",
          "functionParameters": "",
          "query": "",
          "version": ""
        }
      },
      "enabled": true
    },
    {
      "title": "Create Saved Searches",
      "operation": "create_saved_searches",
      "description": "Creates a new saved searches in Azure Log Analytics, based on the input parameters you have specified.",
      "category": "investigation",
      "annotation": "create_saved_searches",
      "parameters": [
        {
          "title": "Saved Search ID",
          "description": "ID of the saved search that you want to create in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "savedSearchId"
        },
        {
          "title": "Workspace Resource Group",
          "description": "Azure active directory resource group from which you want to create a saved searches in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "resourceGroupName"
        },
        {
          "title": "Workspace Subscription ID",
          "description": "Azure active directory subscription ID from which you want to create a saved searches in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "subscriptionId"
        },
        {
          "title": "Workspace Name",
          "description": "Name of the workspace from which you want to create a saved searches in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "workspaceName"
        },
        {
          "title": "Category",
          "description": "Category of the saved search. This helps users quickly find a saved search from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "category"
        },
        {
          "title": "Display Name",
          "description": "Display Name of the saved searches that you want to create in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "displayName"
        },
        {
          "title": "Query",
          "description": "Query Expression for the saved searches that you want to create in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "query",
          "placeholder": "Heartbeat | summarize Count() by Computer | take a"
        },
        {
          "title": "ETag",
          "description": "(Optional) Etag in which you want to create the saved searches in Azure Log Analytics.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "etag",
          "tooltip": "(Optional) Etag in which you want to create the saved searches in Azure Log Analytics."
        },
        {
          "title": "Additional Fields",
          "name": "additional_fields",
          "type": "json",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "(Optional) Additional fields that you want to create saved searches in Azure Log Analytics.",
          "description": "(Optional) Additional fields that you want to create saved searches in Azure Log Analytics."
        }
      ],
      "output_schema": {
        "id": "",
        "etag": "",
        "properties": {
          "category": "",
          "displayName": "",
          "functionAlias": "",
          "functionParameters": "",
          "query": "",
          "version": ""
        }
      },
      "enabled": true
    },
    {
      "title": "Update Saved Searches",
      "operation": "update_saved_searches",
      "description": "Update a existing saved searches in Azure Log Analytics, based on the input parameters you have specified.",
      "category": "investigation",
      "annotation": "update_saved_searches",
      "parameters": [
        {
          "title": "Saved Search ID",
          "description": "ID of the saved search that you want to update in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "savedSearchId"
        },
        {
          "title": "Workspace Resource Group",
          "description": "Azure active directory resource group from which you want to update the saved searches in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "resourceGroupName"
        },
        {
          "title": "Workspace Subscription ID",
          "description": "Azure active directory subscription ID from which you want to update the saved searches in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "subscriptionId"
        },
        {
          "title": "Workspace Name",
          "description": "Name of the workspace from which you want to update the saved searches in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "workspaceName"
        },
        {
          "title": "Category",
          "description": "Category of the saved search. This helps users quickly find a saved search from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "category"
        },
        {
          "title": "Display Name",
          "description": "Display Name of the saved searches that you want to update in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "displayName"
        },
        {
          "title": "Query",
          "description": "Query Expression for the saved searches that you want to update in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "query",
          "placeholder": "Heartbeat | summarize Count() by Computer | take a"
        },
        {
          "title": "ETag",
          "description": "(Optional) Etag in which you want to update the saved searches in Azure Log Analytics.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "etag",
          "tooltip": "(Optional) Etag in which you want to update the saved searches in Azure Log Analytics."
        },
        {
          "title": "Additional Fields",
          "name": "additional_fields",
          "type": "json",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "(Optional) Additional fields that you want to update saved searches in Azure Log Analytics.",
          "description": "(Optional) Additional fields that you want to update saved searches in Azure Log Analytics."
        }
      ],
      "output_schema": {
        "id": "",
        "etag": "",
        "properties": {
          "category": "",
          "displayName": "",
          "functionAlias": "",
          "functionParameters": "",
          "query": "",
          "version": ""
        }
      },
      "enabled": true
    },
    {
      "title": "Delete Saved Search",
      "operation": "delete_saved_search",
      "description": "Deletes a specific saved search from Azure Log Analytics, based on the saved search ID and other input parameters you have specified.",
      "category": "investigation",
      "annotation": "delete_saved_search",
      "parameters": [
        {
          "title": "Saved Search ID",
          "description": "ID of the saved search that you want to delete from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "savedSearchId"
        },
        {
          "title": "Workspace Resource Group",
          "description": "Azure active directory resource group from which you want to delete the saved searches from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "resourceGroupName"
        },
        {
          "title": "Workspace Subscription ID",
          "description": "Azure active directory subscription ID from which you want to delete the saved searches from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "subscriptionId"
        },
        {
          "title": "Workspace Name",
          "description": "Name of the workspace from which you want to delete the saved searches from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "workspaceName"
        }
      ],
      "output_schema": {
        "result": ""
      },
      "enabled": true
    }
  ]
}

