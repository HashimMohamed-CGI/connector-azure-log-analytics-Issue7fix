{
  "description": "Log Analytics is a service that helps you collect and analyze data generated by resources in your cloud and on-premises environments. This connector facilitates the automated operations related to query and saved searches.",
  "category": "Analytics & SIEM",
  "name": "azure-log-analytics",
  "label": "Azure Log Analytics",
  "version": "1.0.0",
  "publisher": "Community",
  "cs_approved": false,
  "cs_compatible": true,
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "help_online": "https://docs.fortinet.com/document/fortisoar/1.0.0/azure-log-analytics/171/azure-log-analytics-v1-0-0",
  "configuration": {
    "fields": [
      {
        "title": "Server URL",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "text",
        "name": "resource",
        "value": "https://graph.microsoft.com",
        "description": "The service-based URI to which you will connect and perform the automated operations."
      },
      {
        "title": "Client ID",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "text",
        "name": "client_id",
        "description": "Unique API ID of the Azure AD application that is used to create an authentication token required to access the API."
      },
      {
        "title": "Client Secret",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "password",
        "name": "client_secret",
        "description": "Unique API Secret of the Azure AD application that is used to create an authentication token required to access the API."
      },
      {
        "title": "Tenant ID",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "text",
        "name": "tenant_id",
        "description": "ID of the tenant that you have been provided for your Azure Active Directory instance."
      },
      {
        "title": "Authorization Code",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "password",
        "name": "code",
        "tooltip": "The authorization code that you acquired during the authorization step. For more information, see Accessing the Azure Log Analytics API.",
        "description": "The authorization code that you acquired during the authorization step. For more information, see Accessing the Azure Log Analytics API."
      },
      {
        "title": "Redirect URL",
        "description": "The redirect_uri of your app, where authentication responses can be sent and received by your app. It must exactly match one of the redirect_uri you registered in the app registration portal.",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "text",
        "name": "redirect_url",
        "placeholder": "E.g. https://localhost/myapp",
        "tooltip": "The redirect_uri of your app, where authentication responses can be sent and received by your app. It must exactly match one of the redirect_uri you registered in the app registration portal."
      },
      {
        "title": "Verify SSL",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "checkbox",
        "name": "verify_ssl",
        "value": true,
        "description": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True.\n"
      }
    ]
  },
  "operations": [
    {
      "title": "Execute Query",
      "operation": "execute_query",
      "description": "Retrieves data using a specific query from Azure Log Analytics based on the workspace ID and query that you have specified.",
      "category": "investigation ",
      "annotation": "execute_query",
      "parameters": [
        {
          "title": "Workspace ID",
          "description": "ID of the Azure Log Analytics workspace from which you want to retrieve data.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "WorkspaceId"
        },
        {
          "title": "Query",
          "description": "Query using which you want to retrieve data from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "query",
          "placeholder": "Usage | take 10",
          "tooltip": "Query using which you want to retrieve data from Azure Log Analytics."
        },
        {
          "title": "TimeSpan",
          "description": "(Optional) Timespan over which you want to query for data in Azure Log Analytics. This is an ISO8601 time period value. This timespan is applied in addition to any timespans. which have been specified in the query expression.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "timespan",
          "placeholder": "PT12H",
          "tooltip": "(Optional) Timespan over which you want to query for data in Azure Log Analytics. This is an ISO8601 time period value. This timespan is applied in addition to any timespans. which have been specified in the query expression."
        },
        {
          "title": "Workspace Name",
          "description": "(Optional) Name of the Azure Log Analytics workspace from which you want to retrieve data.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "workspaces",
          "tooltip": "(Optional) Name of the Azure Log Analytics workspace from which you want to retrieve data."
        }
      ],
      "output_schema": {
        "tables": [
          {
            "name": "",
            "columns": [],
            "rows": []
          }
        ]
      },
      "enabled": true
    },
    {
      "title": "List Saved Searches",
      "operation": "list_saved_searches",
      "description": "Retrieves the list of saved searches from Azure Log Analytics based on workspace resource group, workspace subscription ID, and workspace name you have specified.",
      "category": "investigation ",
      "annotation": "list_saved_searches",
      "parameters": [
        {
          "title": "Workspace Resource Group",
          "description": "Name of the Azure Log Analytics workspace resource group from which you want to retrieve the saved searches.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "resourceGroupName"
        },
        {
          "title": "Workspace Subscription ID",
          "description": "Subscription ID of the Azure Log Analytics workspace from which you want to retrieve the saved searches.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "subscriptionId"
        },
        {
          "title": "Workspace Name",
          "description": "Name of the Azure Log Analytics workspace from which you want to retrieve the saved searches.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "workspaceName"
        }
      ],
      "output_schema": [
        {
          "id": "",
          "etag": "",
          "properties": {
            "Category": "",
            "DisplayName": "",
            "Query": "",
            "Tags": [
            ],
            "Version": ""
          }
        }
      ],
      "enabled": true
    },
    {
      "title": "Get Saved Searches",
      "operation": "get_saved_searches",
      "description": "Retrieves information for a specific saved search from Azure Log Analytics, based on the saved search ID, workspace resource group, workspace subscription ID, and workspace name you have specified.",
      "category": "investigation",
      "annotation": "get_saved_searches",
      "parameters": [
        {
          "title": "Saved Search ID",
          "description": "ID of the saved search that you want to retrieve from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "savedSearchId"
        },
        {
          "title": "Workspace Resource Group",
          "description": "Name of the Azure Log Analytics workspace resource group from which you want to retrieve the specified saved search.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "resourceGroupName"
        },
        {
          "title": "Workspace Subscription ID",
          "description": "Subscription ID of the Azure Log Analytics workspace from which you want to retrieve the specified saved search.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "subscriptionId"
        },
        {
          "title": "Workspace Name",
          "description": "Name of the Azure Log Analytics workspace from which you want to retrieve the specified saved search.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "workspaceName"
        }
      ],
      "output_schema": {
        "id": "",
        "etag": "",
        "properties": {
          "category": "",
          "displayName": "",
          "functionAlias": "",
          "functionParameters": "",
          "query": "",
          "version": ""
        }
      },
      "enabled": true
    },
    {
      "title": "Create Saved Searches",
      "operation": "create_saved_searches",
      "description": "Creates a saved search in Azure Log Analytics, based on the saved search ID, workspace resource group, workspace subscription ID, and workspace name, and other input parameters you have specified.",
      "category": "investigation",
      "annotation": "create_saved_searches",
      "parameters": [
        {
          "title": "Saved Search ID",
          "description": "ID of the saved search that you want to create in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "savedSearchId"
        },
        {
          "title": "Workspace Resource Group",
          "description": "Name of the Azure Log Analytics workspace resource group in which you want to create the saved search.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "resourceGroupName"
        },
        {
          "title": "Workspace Subscription ID",
          "description": "Subscription ID of the Azure Log Analytics workspace in which you want to create the saved search.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "subscriptionId"
        },
        {
          "title": "Workspace Name",
          "description": "Name of the Azure Log Analytics workspace in which you want to create the saved search.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "workspaceName"
        },
        {
          "title": "Category",
          "description": "Category to assign to the saved search that you want to create in Azure Log Analytics. Categorization helps users quickly find a saved search in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "category"
        },
        {
          "title": "Display Name",
          "description": "Display Name of the saved search that you want to create in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "displayName"
        },
        {
          "title": "Query",
          "description": "Query Expression for the saved search that you want to create in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "query",
          "placeholder": "Heartbeat | summarize Count() by Computer | take a",
          "tooltip": "Query Expression for the saved search that you want to create in Azure Log Analytics."
        },
        {
          "title": "ETag",
          "description": "(Optional) Etag in which you want to create the saved search in Azure Log Analytics.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "etag",
          "tooltip": "(Optional) Etag in which you want to create the saved search in Azure Log Analytics."
        },
        {
          "title": "Additional Fields",
          "name": "additional_fields",
          "type": "json",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "(Optional) Additional fields to assign to the saved search that you want to create in Azure Log Analytics.",
          "description": "(Optional) Additional fields to assign to the saved search that you want to create in Azure Log Analytics."
        }
      ],
      "output_schema": {
        "id": "",
        "etag": "",
        "properties": {
          "category": "",
          "displayName": "",
          "functionAlias": "",
          "functionParameters": "",
          "query": "",
          "version": ""
        }
      },
      "enabled": true
    },
    {
      "title": "Update Saved Searches",
      "operation": "update_saved_searches",
      "description": "Updates an existing saved search in Azure Log Analytics, based on the saved search ID, workspace resource group, workspace subscription ID, and workspace name, and other input parameters you have specified.",
      "category": "investigation",
      "annotation": "update_saved_searches",
      "parameters": [
        {
          "title": "Saved Search ID",
          "description": "ID of the saved search that you want to update in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "savedSearchId"
        },
        {
          "title": "Workspace Resource Group",
          "description": "Name of the Azure Log Analytics workspace resource group in which you want to update the saved search.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "resourceGroupName"
        },
        {
          "title": "Workspace Subscription ID",
          "description": "Subscription ID of the Azure Log Analytics workspace in which you want to update the saved search.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "subscriptionId"
        },
        {
          "title": "Workspace Name",
          "description": "Name of the Azure Log Analytics workspace in which you want to update the saved search.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "workspaceName"
        },
        {
          "title": "Category",
          "description": "Category to assign to the saved search that you want to update in Azure Log Analytics. Categorization helps users quickly find a saved search in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "category"
        },
        {
          "title": "Display Name",
          "description": "Display Name of the saved search that you want to update in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "displayName"
        },
        {
          "title": "Query",
          "description": "Query Expression for the saved search that you want to update in Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "query",
          "placeholder": "Heartbeat | summarize Count() by Computer | take a"
        },
        {
          "title": "ETag",
          "description": "(Optional) Etag in which you want to update the saved search in Azure Log Analytics.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "etag",
          "tooltip": "(Optional) Etag in which you want to update the saved search in Azure Log Analytics."
        },
        {
          "title": "Additional Fields",
          "name": "additional_fields",
          "type": "json",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "(Optional) Additional fields to assign to the saved search that you want to update in Azure Log Analytics.",
          "description": "(Optional) Additional fields to assign to the saved search that you want to update in Azure Log Analytics.."
        }
      ],
      "output_schema": {
        "id": "",
        "etag": "",
        "properties": {
          "category": "",
          "displayName": "",
          "functionAlias": "",
          "functionParameters": "",
          "query": "",
          "version": ""
        }
      },
      "enabled": true
    },
    {
      "title": "Delete Saved Search",
      "operation": "delete_saved_search",
      "description": "Deletes a specific saved search from Azure Log Analytics, based on the saved search ID, workspace resource group, workspace subscription ID, and workspace name you have specified.",
      "category": "investigation",
      "annotation": "delete_saved_search",
      "parameters": [
        {
          "title": "Saved Search ID",
          "description": "ID of the saved search that you want to delete from Azure Log Analytics.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "savedSearchId"
        },
        {
          "title": "Workspace Resource Group",
          "description": "Name of the Azure Log Analytics workspace resource group from which you want to delete the saved search.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "resourceGroupName"
        },
        {
          "title": "Workspace Subscription ID",
          "description": "Subscription ID of the Azure Log Analytics workspace from which you want to delete the saved search.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "subscriptionId"
        },
        {
          "title": "Workspace Name",
          "description": "Name of the Azure Log Analytics workspace from which you want to delete the saved search.",
          "required": true,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "workspaceName"
        }
      ],
      "output_schema": {
        "result": ""
      },
      "enabled": true
    }
  ]
}

